/*!
 * @pixi/gif - v1.1.3
 * https://github.com/pixijs/gif
 * Compiled Wed, 21 Sep 2022 20:13:39 UTC
 *
 * @pixi/gif is licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license
 */
this.PIXI=this.PIXI||{},this.PIXI.gif=function(e,t,r,n,i,o,a){"use strict";var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},s(e,t)};var d=function(){return d=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},d.apply(this,arguments)};var c={},u={},l={};Object.defineProperty(l,"__esModule",{value:!0}),l.loop=l.conditional=l.parse=void 0;l.parse=function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;if(Array.isArray(r))r.forEach((function(r){return e(t,r,n,i)}));else if("function"==typeof r)r(t,n,i,e);else{var o=Object.keys(r)[0];Array.isArray(r[o])?(i[o]={},e(t,r[o],n,i[o])):i[o]=r[o](t,n,i,e)}return n};l.conditional=function(e,t){return function(r,n,i,o){t(r,n,i)&&o(r,e,n,i)}};l.loop=function(e,t){return function(r,n,i,o){for(var a=[],s=r.pos;t(r,n,i);){var d={};if(o(r,e,n,d),r.pos===s)break;s=r.pos,a.push(d)}return a}};var p={};Object.defineProperty(p,"__esModule",{value:!0}),p.readBits=p.readArray=p.readUnsigned=p.readString=p.peekBytes=p.readBytes=p.peekByte=p.readByte=p.buildStream=void 0;p.buildStream=function(e){return{data:e,pos:0}};var h=function(){return function(e){return e.data[e.pos++]}};p.readByte=h;p.peekByte=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(t){return t.data[t.pos+e]}};var f=function(e){return function(t){return t.data.subarray(t.pos,t.pos+=e)}};p.readBytes=f;p.peekBytes=function(e){return function(t){return t.data.subarray(t.pos,t.pos+e)}};p.readString=function(e){return function(t){return Array.from(f(e)(t)).map((function(e){return String.fromCharCode(e)})).join("")}};p.readUnsigned=function(e){return function(t){var r=f(2)(t);return e?(r[1]<<8)+r[0]:(r[0]<<8)+r[1]}};p.readArray=function(e,t){return function(r,n,i){for(var o="function"==typeof t?t(r,n,i):t,a=f(e),s=new Array(o),d=0;d<o;d++)s[d]=a(r);return s}};p.readBits=function(e){return function(t){for(var r=function(e){return e.data[e.pos++]}(t),n=new Array(8),i=0;i<8;i++)n[7-i]=!!(r&1<<i);return Object.keys(e).reduce((function(t,r){var i=e[r];return i.length?t[r]=function(e,t,r){for(var n=0,i=0;i<r;i++)n+=e[t+i]&&Math.pow(2,r-i-1);return n}(n,i.index,i.length):t[r]=n[i.index],t}),{})}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=l,r=p,n={blocks:function(e){for(var t=[],n=e.data.length,i=0,o=(0,r.readByte)()(e);0!==o&&o;o=(0,r.readByte)()(e)){if(e.pos+o>=n){var a=n-e.pos;t.push((0,r.readBytes)(a)(e)),i+=a;break}t.push((0,r.readBytes)(o)(e)),i+=o}for(var s=new Uint8Array(i),d=0,c=0;c<t.length;c++)s.set(t[c],d),d+=t[c].length;return s}},i=(0,t.conditional)({gce:[{codes:(0,r.readBytes)(2)},{byteSize:(0,r.readByte)()},{extras:(0,r.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,r.readUnsigned)(!0)},{transparentColorIndex:(0,r.readByte)()},{terminator:(0,r.readByte)()}]},(function(e){var t=(0,r.peekBytes)(2)(e);return 33===t[0]&&249===t[1]})),o=(0,t.conditional)({image:[{code:(0,r.readByte)()},{descriptor:[{left:(0,r.readUnsigned)(!0)},{top:(0,r.readUnsigned)(!0)},{width:(0,r.readUnsigned)(!0)},{height:(0,r.readUnsigned)(!0)},{lct:(0,r.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,t.conditional)({lct:(0,r.readArray)(3,(function(e,t,r){return Math.pow(2,r.descriptor.lct.size+1)}))},(function(e,t,r){return r.descriptor.lct.exists})),{data:[{minCodeSize:(0,r.readByte)()},n]}]},(function(e){return 44===(0,r.peekByte)()(e)})),a=(0,t.conditional)({text:[{codes:(0,r.readBytes)(2)},{blockSize:(0,r.readByte)()},{preData:function(e,t,n){return(0,r.readBytes)(n.text.blockSize)(e)}},n]},(function(e){var t=(0,r.peekBytes)(2)(e);return 33===t[0]&&1===t[1]})),s=(0,t.conditional)({application:[{codes:(0,r.readBytes)(2)},{blockSize:(0,r.readByte)()},{id:function(e,t,n){return(0,r.readString)(n.blockSize)(e)}},n]},(function(e){var t=(0,r.peekBytes)(2)(e);return 33===t[0]&&255===t[1]})),d=(0,t.conditional)({comment:[{codes:(0,r.readBytes)(2)},n]},(function(e){var t=(0,r.peekBytes)(2)(e);return 33===t[0]&&254===t[1]})),c=[{header:[{signature:(0,r.readString)(3)},{version:(0,r.readString)(3)}]},{lsd:[{width:(0,r.readUnsigned)(!0)},{height:(0,r.readUnsigned)(!0)},{gct:(0,r.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,r.readByte)()},{pixelAspectRatio:(0,r.readByte)()}]},(0,t.conditional)({gct:(0,r.readArray)(3,(function(e,t){return Math.pow(2,t.lsd.gct.size+1)}))},(function(e,t){return t.lsd.gct.exists})),{frames:(0,t.loop)([i,s,d,o,a],(function(e){var t=(0,r.peekByte)()(e);return 33===t||44===t}))}];e.default=c}(u);var y={};Object.defineProperty(y,"__esModule",{value:!0}),y.deinterlace=void 0;y.deinterlace=function(e,t){for(var r=new Array(e.length),n=e.length/t,i=function(n,i){var o=e.slice(i*t,(i+1)*t);r.splice.apply(r,[n*t,t].concat(o))},o=[0,4,2,1],a=[8,8,4,2],s=0,d=0;d<4;d++)for(var c=o[d];c<n;c+=a[d])i(c,s),s++;return r};var g={};Object.defineProperty(g,"__esModule",{value:!0}),g.lzw=void 0;g.lzw=function(e,t,r){var n,i,o,a,s,d,c,u,l,p,h,f,y,g,m,v,_=4096,x=r,b=new Array(r),w=new Array(_),T=new Array(_),I=new Array(4097);for(s=(i=1<<(p=e))+1,n=i+2,c=-1,o=(1<<(a=p+1))-1,u=0;u<i;u++)w[u]=0,T[u]=u;for(h=f=y=g=m=v=0,l=0;l<x;){if(0===g){if(f<a){h+=t[v]<<f,f+=8,v++;continue}if(u=h&o,h>>=a,f-=a,u>n||u==s)break;if(u==i){o=(1<<(a=p+1))-1,n=i+2,c=-1;continue}if(-1==c){I[g++]=T[u],c=u,y=u;continue}for(d=u,u==n&&(I[g++]=y,u=c);u>i;)I[g++]=T[u],u=w[u];y=255&T[u],I[g++]=y,n<_&&(w[n]=c,T[n]=y,0==(++n&o)&&n<_&&(a++,o+=n)),c=d}g--,b[m++]=I[g],l++}for(l=m;l<x;l++)b[l]=0;return b},Object.defineProperty(c,"__esModule",{value:!0});var m,v=c.decompressFrames=c.decompressFrame=I=c.parseGIF=void 0,_=(m=u)&&m.__esModule?m:{default:m},x=l,b=p,w=y,T=g;var I=c.parseGIF=function(e){var t=new Uint8Array(e);return(0,x.parse)((0,b.buildStream)(t),_.default)},O=function(e,t,r){if(e.image){var n=e.image,i=n.descriptor.width*n.descriptor.height,o=(0,T.lzw)(n.data.minCodeSize,n.data.blocks,i);n.descriptor.lct.interlaced&&(o=(0,w.deinterlace)(o,n.descriptor.width));var a={pixels:o,dims:{top:e.image.descriptor.top,left:e.image.descriptor.left,width:e.image.descriptor.width,height:e.image.descriptor.height}};return n.descriptor.lct&&n.descriptor.lct.exists?a.colorTable=n.lct:a.colorTable=t,e.gce&&(a.delay=10*(e.gce.delay||10),a.disposalType=e.gce.extras.disposal,e.gce.extras.transparentColorGiven&&(a.transparentIndex=e.gce.transparentColorIndex)),r&&(a.patch=function(e){for(var t=e.pixels.length,r=new Uint8ClampedArray(4*t),n=0;n<t;n++){var i=4*n,o=e.pixels[n],a=e.colorTable[o]||[0,0,0];r[i]=a[0],r[i+1]=a[1],r[i+2]=a[2],r[i+3]=o!==e.transparentIndex?255:0}return r}(a)),a}};c.decompressFrame=O;v=c.decompressFrames=function(e,t){return e.frames.filter((function(e){return e.image})).map((function(r){return O(r,e.gct,t)}))};var B=function(e){function t(r,i){var o=this,a=Object.assign({},t.defaultOptions,i),s=a.scaleMode,d=a.width,c=a.height,u=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(a,["scaleMode","width","height"]),l=document.createElement("canvas"),p=l.getContext("2d");return l.width=d,l.height=c,(o=e.call(this,n.Texture.from(l,{scaleMode:s}))||this).duration=r[r.length-1].end,o._frames=r,o._context=p,o._playing=!1,o._currentTime=0,o._isConnectedToTicker=!1,Object.assign(o,u),o.currentFrame=0,o.autoPlay&&o.play(),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t.fromBuffer=function(e,r){if(!e||0===e.byteLength)throw new Error("Invalid buffer");var n=I(e);!function(e){for(var t,r=null,n=0,i=e.frames;n<i.length;n++){var o=i[n];r=null!==(t=o.gce)&&void 0!==t?t:r,"image"in o&&!("gce"in o)&&(o.gce=r)}}(n);var i=v(n,!0),o=[],a=document.createElement("canvas"),s=a.getContext("2d"),c=document.createElement("canvas"),u=c.getContext("2d");a.width=n.lsd.width,a.height=n.lsd.height;for(var l=0,p=1e3/Object.assign({},t.defaultOptions,r).fps,h=0;h<i.length;h++){var f=i[h],y=f.disposalType,g=void 0===y?2:y,m=f.delay,_=void 0===m?p:m,x=f.patch,b=f.dims,w=b.width,T=b.height,O=b.left,B=b.top;c.width=w,c.height=T,u.clearRect(0,0,w,T);var P=u.createImageData(w,T);P.data.set(x),u.putImageData(P,0,0),s.drawImage(c,O,B);var k=s.getImageData(0,0,a.width,a.height);2!==g&&3!==g||s.clearRect(0,0,a.width,a.height),o.push({start:l,end:l+_,imageData:k}),l+=_}a.width=a.height=0,c.width=c.height=0;var C=n.lsd,F=C.width,S=C.height;return new t(o,d({width:F,height:S},r))},t.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(a.Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1))},t.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(a.Ticker.shared.add(this.update,this,a.UPDATE_PRIORITY.HIGH),this._isConnectedToTicker=!0),this.loop||this.currentFrame!==this._frames.length-1||(this._currentTime=0))},Object.defineProperty(t.prototype,"progress",{get:function(){return this._currentTime/this.duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),t.prototype.update=function(e){var t,r;if(this._playing){var n=this.animationSpeed*e/i.settings.TARGET_FPMS,o=this._currentTime+n,a=o%this.duration,s=this._frames.findIndex((function(e){return e.start<=a&&e.end>a}));o>=this.duration?this.loop?(this._currentTime=a,this.updateFrameIndex(s),null===(t=this.onLoop)||void 0===t||t.call(this)):(this._currentTime=this.duration,this.updateFrameIndex(this._frames.length-1),null===(r=this.onComplete)||void 0===r||r.call(this),this.stop()):(this._currentTime=a,this.updateFrameIndex(s))}},t.prototype.updateFrame=function(){if(this.dirty){var e=this._frames[this._currentFrame].imageData;this._context.putImageData(e,0,0),this._context.fillStyle="transparent",this._context.fillRect(0,0,0,1),this.texture.update(),this.dirty=!1}},t.prototype._render=function(t){this.updateFrame(),e.prototype._render.call(this,t)},t.prototype._renderCanvas=function(t){this.updateFrame(),e.prototype._renderCanvas.call(this,t)},Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(a.Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(a.Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentFrame",{get:function(){return this._currentFrame},set:function(e){this.updateFrameIndex(e),this._currentTime=this._frames[e].start},enumerable:!1,configurable:!0}),t.prototype.updateFrameIndex=function(e){var t;if(e<0||e>=this._frames.length)throw new Error("Frame index out of range, expecting 0 to ".concat(this.totalFrames,", got ").concat(e));this._currentFrame!==e&&(this._currentFrame=e,this.dirty=!0,null===(t=this.onFrameChange)||void 0===t||t.call(this,e))},Object.defineProperty(t.prototype,"totalFrames",{get:function(){return this._frames.length},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){this.stop(),e.prototype.destroy.call(this,!0),this._context=null,this._frames=null,this.onComplete=null,this.onFrameChange=null,this.onLoop=null},t.prototype.clone=function(){return new t(function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}([],this._frames,!0),{autoUpdate:this._autoUpdate,loop:this.loop,autoPlay:this.autoPlay,scaleMode:this.texture.baseTexture.scaleMode,animationSpeed:this.animationSpeed,width:this._context.canvas.width,height:this._context.canvas.height,onComplete:this.onComplete,onFrameChange:this.onFrameChange,onLoop:this.onLoop})},t.defaultOptions={scaleMode:o.SCALE_MODES.LINEAR,fps:a.Ticker.shared.FPS,loop:!0,animationSpeed:1,autoPlay:!0,autoUpdate:!0,onComplete:null,onFrameChange:null,onLoop:null},t}(r.Sprite),P="gif",k={add:function(){t.LoaderResource.setExtensionXhrType(P,t.LoaderResource.XHR_RESPONSE_TYPE.BUFFER),t.LoaderResource.setExtensionLoadType(P,t.LoaderResource.LOAD_TYPE.XHR)},use:function(e,t){e.extension===P&&(e.animation=B.fromBuffer(e.data)),t()}};return e.AnimatedGIF=B,e.AnimatedGIFLoader=k,Object.defineProperty(e,"__esModule",{value:!0}),e}({},PIXI,PIXI,PIXI,PIXI,PIXI,PIXI);
//# sourceMappingURL=pixi-gif.js.map
